{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jrrrrr/CS50W/final/dorm/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jrrrrr/CS50W/final/dorm/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jrrrrr/CS50W/final/dorm/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import{useEffect,useState}from'react';import{getCSRF}from'../features/auth/authService';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Devices(_ref){var toast=_ref.toast;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),devices=_useState2[0],setDevices=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),trigger=_useState4[0],setTrigger=_useState4[1];useEffect(function(){function getDevices(){return _getDevices.apply(this,arguments);}function _getDevices(){_getDevices=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var config,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return getCSRF();case 2:config=_context.sent;_context.next=5;return axios.get('device/get',{},config);case 5:response=_context.sent;setDevices(response.data);case 7:case\"end\":return _context.stop();}},_callee);}));return _getDevices.apply(this,arguments);}getDevices();},[trigger]);function onDelete(_x){return _onDelete.apply(this,arguments);}function _onDelete(){_onDelete=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id){var config,userData,response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getCSRF();case 2:config=_context2.sent;userData={id:id};_context2.prev=4;_context2.next=7;return axios.post('device/delete',userData,config);case 7:response=_context2.sent;toast.success(response.data.message);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](4);toast.error(_context2.t0.response.data.error);case 14:setTrigger(id);case 15:case\"end\":return _context2.stop();}},_callee2,null,[[4,11]]);}));return _onDelete.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-3\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"My Devices\"})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(DevicesTable,{devices:devices,onDelete:onDelete})]});}function DevicesTable(_ref2){var devices=_ref2.devices,onDelete=_ref2.onDelete;var rows=[];for(var id in devices){rows.push(/*#__PURE__*/_jsx(DeviceTableRow,{device:devices[id],onDelete:onDelete},id));}return/*#__PURE__*/_jsxs(\"table\",{className:\"table align-middle\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"MAC Address\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows})]});}function DeviceTableRow(_ref3){var device=_ref3.device,onDelete=_ref3.onDelete;function onButtonPress(e){onDelete(e.target.dataset.id);}return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:device['mac']}),/*#__PURE__*/_jsx(\"td\",{children:device['type']}),/*#__PURE__*/_jsx(\"td\",{children:device['confirmed']?'Registered':'Pending'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",\"data-id\":device['id'],className:\"btn btn-outline-danger\",onClick:onButtonPress,children:\"delete\"})})]});}","map":{"version":3,"names":["axios","useEffect","useState","getCSRF","jsx","_jsx","jsxs","_jsxs","Devices","_ref","toast","_useState","_useState2","_slicedToArray","devices","setDevices","_useState3","_useState4","trigger","setTrigger","getDevices","_getDevices","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","config","response","wrap","_callee$","_context","prev","next","sent","get","data","stop","onDelete","_x","_onDelete","_callee2","id","userData","_callee2$","_context2","post","success","message","t0","error","className","children","DevicesTable","_ref2","rows","push","DeviceTableRow","device","_ref3","onButtonPress","e","target","dataset","type","onClick"],"sources":["/Users/jrrrrr/CS50W/final/dorm/frontend/src/pages/Devices.js"],"sourcesContent":["import axios from 'axios'\nimport { useEffect, useState } from 'react'\nimport { getCSRF } from '../features/auth/authService'\n\n\nexport default function Devices({ toast }) {\n    const [devices, setDevices] = useState({})\n    const [trigger, setTrigger] = useState()\n\n    useEffect(() => {\n        async function getDevices() {\n            const config = await getCSRF()\n            const response = await axios.get('device/get', {}, config)\n            setDevices(response.data)\n        }\n        getDevices()\n    }, [trigger])\n\n\n    async function onDelete(id) {\n        const config = await getCSRF()\n        const userData = {\n            id\n        }\n\n        try {\n            const response = await axios.post('device/delete', userData, config)\n            toast.success(response.data.message)\n        }\n        catch (error) {\n            toast.error(error.response.data.error)\n        }\n        setTrigger(id)\n    }\n\n\n    return (\n        <div className=\"container\">\n            <div className=\"text-center mb-3\">\n                <h1>My Devices</h1>\n            </div>\n            <hr />\n            <DevicesTable devices={devices} onDelete={onDelete} />\n        </div>\n    )\n}\n\nfunction DevicesTable({ devices, onDelete }) {\n    let rows = []\n\n    for (let id in devices) {\n        rows.push(<DeviceTableRow key={id} device={devices[id]} onDelete={onDelete} />)\n    }\n\n    return (\n        <table className=\"table align-middle\">\n            <thead>\n                <tr>\n                    <th>MAC Address</th>\n                    <th>Type</th>\n                    <th>Status</th>\n                    <th></th>\n                </tr>\n            </thead>\n            <tbody>\n                {rows}\n            </tbody>\n        </table>\n    )\n}\n\nfunction DeviceTableRow({ device, onDelete }) {\n    function onButtonPress(e) {\n        onDelete(e.target.dataset.id)\n    }\n    return (\n        <tr>\n            <td>\n                {device['mac']}\n            </td>\n            <td>\n                {device['type']}\n            </td>\n            <td>\n                {device['confirmed'] ? 'Registered' : 'Pending'}\n            </td>\n            <td>\n                <button type=\"button\" data-id={device['id']} className=\"btn btn-outline-danger\" onClick={onButtonPress}>delete</button>\n            </td>\n        </tr>\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}